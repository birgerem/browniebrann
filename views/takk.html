<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Takk for Bestillingen! â€“ BrownieBrannâ„¢</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <nav class="navbar">
    <a href="/" class="logo">ğŸ« BrownieBrannâ„¢</a>
    <div class="nav-links">
      <a href="/">Hjem</a>
      <a href="/meny">Meny</a>
      <a href="/om-oss">Om Oss</a>
      <a href="/handlekurv" class="cart-link">
        ğŸ›’ Handlekurv
        <span class="cart-badge" id="cart-badge">0</span>
      </a>
    </div>
    <button class="hamburger" id="hamburger">â˜°</button>
  </nav>

  <section class="takk-section">
    <div class="takk-content">
      <div class="takk-animation">
        <div class="confetti-container" id="confetti"></div>
        <div class="takk-icon">ğŸ‰</div>
      </div>

      <h1>Bestillingen er mottatt!</h1>
      <p class="takk-sub">Takk for at du stolte pÃ¥ oss, <strong id="customer-name">venn</strong>!</p>

      <div class="takk-card">
        <h2>Hva skjer nÃ¥?</h2>
        <div class="steps">
          <div class="step">
            <span class="step-icon">ğŸ“§</span>
            <div>
              <strong>Bekreftelse pÃ¥ e-post</strong>
              <p>Vi sender en bekreftelse til e-posten din snart.</p>
            </div>
          </div>
          <div class="step">
            <span class="step-icon">ğŸ«</span>
            <div>
              <strong>Vi baker brownies</strong>
              <p>Ovnene er varme. Sjokoladen smelter. Magien skjer.</p>
            </div>
          </div>
          <div class="step">
            <span class="step-icon">ğŸšš</span>
            <div>
              <strong>Levering pÃ¥ vei!</strong>
              <p>Browniene pakkes forsiktig og sendes din vei.</p>
            </div>
          </div>
          <div class="step" id="betaling-steg">
            <span class="step-icon" id="betaling-ikon">ğŸ’³</span>
            <div>
              <strong id="betaling-tittel">Betaling</strong>
              <p id="betaling-tekst">Vi sender deg betalingsinformasjon pÃ¥ e-post.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Vipps-betalingskort â€“ vises kun ved Vipps-valg -->
      <div class="vipps-payment-card" id="vipps-card" style="display:none;">
        <img src="https://media.ffycdn.net/eu/vipps/bsCfHB667aHWogtuXGqJ.png" class="vipps-logo-lg" alt="Vipps">
        <h3>Du betaler med Vipps</h3>
        <div class="vipps-amount" id="vipps-amount">0 kr</div>
        <p>Vi sender deg Vipps-informasjon direkte â€“ sjekk e-posten din! ğŸ“§</p>
        <p class="vipps-note">Browniene er klare nÃ¥r vi har mottatt betalingen. ğŸ«</p>
      </div>

      <!-- Kontant-info â€“ vises kun ved "betal ved levering" -->
      <div class="cash-payment-card" id="cash-card" style="display:none;">
        <span style="font-size:2.5rem;">ğŸ’µ</span>
        <h3>Du betaler ved levering / henting</h3>
        <p>Ha kontanter eller Vipps klart nÃ¥r browniene ankommer. Vi gleder oss!</p>
      </div>

      <div class="order-summary-takk" id="order-summary-takk">
        <h3>Din bestilling:</h3>
        <div id="takk-items"></div>
        <div class="takk-total">
          <span>Totalt betalt:</span>
          <strong id="takk-total">â€“</strong>
        </div>
      </div>

      <div class="takk-meme">
        <p>"Du er nÃ¥ offisielt en BrownieBrannâ„¢-kunde."</p>
        <p style="opacity:0.6; font-size:0.85rem;">Det er ikke et sertifikat, men det burde det vÃ¦rt.</p>
      </div>

      <div class="takk-buttons">
        <a href="/meny" class="btn btn-primary">ğŸ« Bestill Mer</a>
        <a href="/" class="btn btn-secondary">â† Tilbake til forsiden</a>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-logo">ğŸ« BrownieBrannâ„¢</div>
      <p>Det tryggeste farlige navnet pÃ¥ en brownie-butikk.</p>
      <div class="footer-links">
        <a href="/">Hjem</a>
        <a href="/meny">Meny</a>
        <a href="/om-oss">Om Oss</a>
        <a href="/handlekurv">Handlekurv</a>
      </div>
    </div>
  </footer>

  <script src="/js/cart.js"></script>
  <script>
    // Show order summary from localStorage
    const lastOrder = JSON.parse(localStorage.getItem('lastOrder') || '{}');
    if (lastOrder.name) {
      document.getElementById('customer-name').textContent = lastOrder.name;
    }

    let totalBelÃ¸p = 0;
    if (lastOrder.items && lastOrder.items.length > 0) {
      const container = document.getElementById('takk-items');
      lastOrder.items.forEach(item => {
        const row = document.createElement('div');
        row.className = 'takk-item-row';
        row.innerHTML = `<span>${item.emoji} ${item.name} Ã— ${item.qty}</span><span>${item.price * item.qty} kr</span>`;
        container.appendChild(row);
      });
      const shipping = lastOrder.delivery === 'pickup' ? 0 : 49;
      const subtotal = lastOrder.items.reduce((s, i) => s + i.price * i.qty, 0);
      totalBelÃ¸p = subtotal + shipping;
      document.getElementById('takk-total').textContent = totalBelÃ¸p + ' kr';
    }

    // Vis betalingsinfo basert pÃ¥ valgt metode
    const payment = lastOrder.payment || 'vipps';
    if (payment === 'vipps') {
      document.getElementById('vipps-card').style.display = '';
      document.getElementById('vipps-amount').textContent = totalBelÃ¸p + ' kr';
      document.getElementById('betaling-ikon').textContent = 'ğŸ“±';
      document.getElementById('betaling-tittel').textContent = 'Betal med Vipps';
      document.getElementById('betaling-tekst').textContent = 'Vi sender Vipps-info pÃ¥ e-post. Browniene er klare etter betaling!';
    } else {
      document.getElementById('cash-card').style.display = '';
      document.getElementById('betaling-ikon').textContent = 'ğŸ’µ';
      document.getElementById('betaling-tittel').textContent = 'Betal ved levering / henting';
      document.getElementById('betaling-tekst').textContent = 'Ha kontanter eller Vipps klart. Vi er fleksible!';
    }

    // Confetti effect
    function makeConfetti() {
      const colors = ['#4A2C2A','#FDE9A7','#CDEBFF','#F7F2E9','#e07b54','#f9c74f'];
      const container = document.getElementById('confetti');
      for (let i = 0; i < 60; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.cssText = `
          left: ${Math.random()*100}%;
          background: ${colors[Math.floor(Math.random()*colors.length)]};
          animation-delay: ${Math.random()*2}s;
          animation-duration: ${2 + Math.random()*2}s;
          width: ${8 + Math.random()*8}px;
          height: ${8 + Math.random()*8}px;
          border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
        `;
        container.appendChild(piece);
      }
    }
    makeConfetti();

    // Clear cart after successful order
    localStorage.removeItem('brownieBrannCart');
  </script>
</body>
</html>
